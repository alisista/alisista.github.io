{"version":3,"sources":["webpack:///./src/pages/oauth.js","webpack:///./.cache/public-page-renderer.js","webpack:///./.cache/gatsby-browser-entry.js","webpack:///./src/components/layout.js","webpack:///./.cache/public-page-renderer-prod.js","webpack:///./src/components/footer.js","webpack:///./src/lib/auth.js"],"names":["HTML","props","_this","_Component","call","this","redirectedUrl","location","href","parsedUrl","url__WEBPACK_IMPORTED_MODULE_7___default","a","parse","redirect","query","s","d","p","origin","search","state","render","console","log","body","render_wrongPage","render_oauth","react__WEBPACK_IMPORTED_MODULE_2___default","createElement","_components_layout__WEBPACK_IMPORTED_MODULE_4__","react_helmet__WEBPACK_IMPORTED_MODULE_3___default","link","rel","type","className","_components_footer__WEBPACK_IMPORTED_MODULE_5__","items","key","t","react__WEBPACK_IMPORTED_MODULE_2__","Component","__webpack_exports__","default","h","152","e","m","module","exports","__webpack_require__","r","graphql","StaticQueryContext","StaticQuery","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","prop_types__WEBPACK_IMPORTED_MODULE_1__","prop_types__WEBPACK_IMPORTED_MODULE_1___default","gatsby_link__WEBPACK_IMPORTED_MODULE_2__","gatsby_link__WEBPACK_IMPORTED_MODULE_2___default","withPrefix","navigate","push","replace","navigateTo","_public_page_renderer__WEBPACK_IMPORTED_MODULE_3__","_public_page_renderer__WEBPACK_IMPORTED_MODULE_3___default","_parse_path__WEBPACK_IMPORTED_MODULE_4__","createContext","Consumer","staticQueryData","data","children","Error","propTypes","object","string","isRequired","func","Layout","_ref","react__WEBPACK_IMPORTED_MODULE_1___default","gatsby__WEBPACK_IMPORTED_MODULE_4__","Fragment","title","site","siteMetadata","meta","name","content","lang","_public_static_d_755544856_json__WEBPACK_IMPORTED_MODULE_0__","prop_types__WEBPACK_IMPORTED_MODULE_2___default","node","u","157","159","_page_renderer__WEBPACK_IMPORTED_MODULE_2__","_loader__WEBPACK_IMPORTED_MODULE_3__","ProdPageRenderer","pageResources","getResourcesForPathname","pathname","shape","l","163","o","link_items","_iterator","_isArray","Array","isArray","_i","Symbol","iterator","length","next","done","value","v","react__WEBPACK_IMPORTED_MODULE_5___default","target","react__WEBPACK_IMPORTED_MODULE_5__","i","167","c","firebase__WEBPACK_IMPORTED_MODULE_5___default","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","timestampsInSnapshots","Auth","component","opts","window","WavesAPI","Waves","create","MAINNET_CONFIG","db","firestore","provider","auth","TwitterAuthProvider","useDeviceLanguage","onAuthStateChanged","user","obj","twitter_user","displayName","photoURL","uid","id","providerData","setState","isUser","getUserInfo","prototype","setData","cb","err","_this2","alerts","pushAlert","collection","doc","set","merge","then","ss","catch","updateData","_this3","toString","match","update","_this4","get","userInfo","oauth","validateWavesAddress","login","signInWithPopup","error","alert","logout","signOut","popup_url","signedData","publicKey","address","_signedData$split","split","random_value","crypto","isValidAddress","addWavesAddress","publickKey","added_at","Date","now","setAsReceiver","_this5","waves_addresses","k","receiver","setWavesAddress","checkAddressInPool","_this6","exists","_this7","underscore__WEBPACK_IMPORTED_MODULE_8___default","isEmpty","addAddressToPool","_this8","removeAddressFromPool","delete","genRandomValue","_this9","uuid","uuid_v4__WEBPACK_IMPORTED_MODULE_6___default","removeWavesAddress","_this10"],"mappings":"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","file":"component---src-pages-oauth-js-97aa55d5905dd9fecd98.js","sourcesContent":["import React, { Component } from 'react'\nimport Helmet from 'react-helmet'\nimport Layout from '../components/layout'\nimport Footer from '../components/footer'\n\nimport auth from '../lib/auth'\nimport url from 'url'\n\nclass HTML extends Component {\n  constructor(props) {\n    super(props)\n    let redirectedUrl = props.location.href\n    const parsedUrl = url.parse(redirectedUrl, true)\n    let redirect = null\n    if (\n      parsedUrl.query.a != undefined &&\n      parsedUrl.query.s != undefined &&\n      parsedUrl.query.d != undefined &&\n      parsedUrl.query.p != undefined\n    ) {\n      redirect = props.location.origin + '/home/' + props.location.search\n    }\n    this.state = {\n      redirect: redirect,\n    }\n  }\n  render() {\n    console.log(this.state.redirect)\n    let user\n    let body =\n      this.state.redirect === undefined\n        ? this.render_wrongPage()\n        : this.render_oauth()\n    let footer_links = [\n      { key: 'twitter', href: 'https://twitter.com/alishackers' },\n      { key: 'github', href: 'https://github.com/alisista' },\n      { key: 'discord', href: 'https://discord.gg/TyKbbrT' },\n    ]\n    return (\n      <Layout>\n        <Helmet\n          link={[\n            {\n              rel: 'stylesheet',\n              type: 'text/css',\n              href: '/tabler/css/tabler.min.css',\n            },\n            {\n              rel: 'stylesheet',\n              type: 'text/css',\n              href: '/css/common.css',\n            },\n          ]}\n        />\n\n        <div className=\"page\">\n          <div className=\"flax-fill\">\n            <div className=\"header py-4\">\n              <div className=\"container\">\n                <div className=\"d-flex\">\n                  <a className=\"header-brand\" href=\"/\">\n                    ALIS HackerToken\n                  </a>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div className=\"my-3 my-md-5\">{body}</div>\n        <Footer items={footer_links} />\n      </Layout>\n    )\n  }\n  render_wrongPage() {\n    return (\n      <div className=\"page\">\n        <div className=\"page-content\">\n          <div className=\"container text-center\">\n            <div className=\"display-1 text-muted mb-5\">\n              <i className=\"si si-exclamation\" /> 404\n            </div>\n\n            <h1 className=\"h2 mb-3\">お探しのページは見つかりませんでした。</h1>\n            <p className=\"h4 text-muted font-weight-normal mb-7\">\n              法定通貨に依存しない完全独自経済圏で好きなことを追求して生きていこう！\n            </p>\n\n            <a className=\"btn btn-primary\" href=\"/\">\n              <i className=\"fe fe-arrow-left mr-2\" />\n              トップページへ戻る\n            </a>\n          </div>\n        </div>\n      </div>\n    )\n  }\n  render_oauth() {\n    return (\n      <div className=\"page\">\n        <div className=\"page-content\">\n          <div className=\"container text-center\">\n            <div className=\"display-1 text-muted mb-5\">\n              <i className=\"si si-exclamation\" /> 認証中\n            </div>\n\n            <h1 className=\"h2 mb-3\">\n              リダイレクト待ちです。少々お待ち下さい。\n            </h1>\n            <p className=\"h4 text-muted font-weight-normal mb-7\">\n              自動的にリダイレクトされない場合は、下のボタンをクリックして手動で移動して下さい。\n            </p>\n\n            <a className=\"btn btn-primary\" href={this.state.redirect}>\n              <i className=\"fe fe-arrow-left mr-2\" />\n              認証を続ける\n            </a>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default HTML\n","const preferDefault = m => (m && m.default) || m\n\nif (process.env.BUILD_STAGE === `develop`) {\n  module.exports = preferDefault(require(`./public-page-renderer-dev`))\n} else if (process.env.BUILD_STAGE === `build-javascript`) {\n  module.exports = preferDefault(require(`./public-page-renderer-prod`))\n} else {\n  module.exports = () => null\n}\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport Link, {\n  withPrefix,\n  navigate,\n  push,\n  replace,\n  navigateTo,\n} from \"gatsby-link\"\nimport PageRenderer from \"./public-page-renderer\"\nimport parsePath from \"./parse-path\"\n\nconst StaticQueryContext = React.createContext({})\n\nconst StaticQuery = props => (\n  <StaticQueryContext.Consumer>\n    {staticQueryData => {\n      if (\n        props.data ||\n        (staticQueryData[props.query] && staticQueryData[props.query].data)\n      ) {\n        return (props.render || props.children)(\n          props.data ? props.data.data : staticQueryData[props.query].data\n        )\n      } else {\n        return <div>Loading (StaticQuery)</div>\n      }\n    }}\n  </StaticQueryContext.Consumer>\n)\n\nStaticQuery.propTypes = {\n  data: PropTypes.object,\n  query: PropTypes.string.isRequired,\n  render: PropTypes.func,\n  children: PropTypes.func,\n}\n\nfunction graphql() {\n  throw new Error(\n    `It appears like Gatsby is misconfigured. Gatsby related \\`graphql\\` calls ` +\n      `are supposed to only be evaluated at compile time, and then compiled away,. ` +\n      `Unfortunately, something went wrong and the query was left in the compiled code.\\n\\n.` +\n      `Unless your site has a complex or custom babel/Gatsby configuration this is likely a bug in Gatsby.`\n  )\n}\n\nexport {\n  Link,\n  withPrefix,\n  graphql,\n  parsePath,\n  navigate,\n  push, // TODO replace for v3\n  replace, // TODO remove replace for v3\n  navigateTo, // TODO: remove navigateTo for v3\n  StaticQueryContext,\n  StaticQuery,\n  PageRenderer,\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Helmet from 'react-helmet'\nimport { StaticQuery, graphql } from 'gatsby'\n\nconst Layout = ({ children }) => (\n  <StaticQuery\n    query={graphql`\n      query SiteTitleQuery {\n        site {\n          siteMetadata {\n            title\n          }\n        }\n      }\n    `}\n    render={data => (\n      <>\n        <Helmet\n          title={data.site.siteMetadata.title}\n          meta={[\n            {\n              name: 'description',\n              content: '法定通貨に依存しない完全独自経済圏',\n            },\n            { name: 'keywords', content: 'ALIS Hacker Token, ALISハッカー部' },\n          ]}\n        >\n          <html lang=\"en\" />\n        </Helmet>\n        {children}\n      </>\n    )}\n  />\n)\n\nLayout.propTypes = {\n  children: PropTypes.node.isRequired,\n}\n\nexport default Layout\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\n\nimport InternalPageRenderer from \"./page-renderer\"\nimport loader from \"./loader\"\n\nconst ProdPageRenderer = ({ location }) => {\n  const pageResources = loader.getResourcesForPathname(location.pathname)\n  return React.createElement(InternalPageRenderer, {\n    location,\n    pageResources,\n  })\n}\n\nProdPageRenderer.propTypes = {\n  location: PropTypes.shape({\n    pathname: PropTypes.string.isRequired,\n  }).isRequired,\n}\n\nexport default ProdPageRenderer\n","import React, { Component } from 'react'\n\nclass HTML extends Component {\n  constructor(props) {\n    super(props)\n  }\n  render() {\n    let link_items = []\n    for (let v of this.props.items) {\n      link_items.push(\n        <li className=\"list-inline-item\">\n          <a href={v.href} target=\"_blank\">\n            <i className={`fab fa-${v.key}`} />\n          </a>\n        </li>\n      )\n    }\n    return (\n      <footer>\n        <div className=\"container\">\n          <div className=\"row\">\n            <div className=\"col-md-4\">\n              <span className=\"copyright\">\n                Copyright &copy; ALISハッカー部 2018\n              </span>\n            </div>\n            <div className=\"col-md-4\">\n              <ul className=\"list-inline social-buttons\">{link_items}</ul>\n            </div>\n            <div className=\"col-md-4\">\n              <ul className=\"list-inline quicklinks\" />\n            </div>\n          </div>\n        </div>\n      </footer>\n    )\n  }\n}\n\nexport default HTML\n","import firebase from 'firebase'\nimport uuidv4 from 'uuid/v4'\nimport url from 'url'\nimport _ from 'underscore'\n\n// firestore\nrequire('firebase/firestore')\nconst config = {\n  apiKey: process.env.FIREBASE_API_KEY,\n  authDomain: `${process.env.FIREBASE_PROJECT_ID}.firebaseapp.com`,\n  databaseURL: `https://${process.env.FIREBASE_DATABASE_NAME}.firebaseio.com`,\n  projectId: process.env.FIREBASE_PROJECT_ID,\n  storageBucket: `${process.env.FIREBASE_BUCKET}.appspot.com`,\n  messagingSenderId: process.env.FIREBASE_SENDER_ID,\n  timestampsInSnapshots: true,\n}\nfirebase.initializeApp(config)\n\nclass Auth {\n  constructor(component, opts = {}) {\n    this.opts = opts\n    this.component = component\n    if (typeof window !== 'undefined') {\n      const WavesAPI = require('@waves/waves-api')\n      this.Waves = WavesAPI.create(WavesAPI.MAINNET_CONFIG)\n      this.db = firebase.firestore()\n      this.provider = new firebase.auth.TwitterAuthProvider()\n      firebase.auth().useDeviceLanguage()\n      firebase.auth().onAuthStateChanged((user, obj) => {\n        if (user) {\n          let twitter_user = {\n            displayName: user.displayName,\n            photoURL: user.photoURL,\n            uid: user.uid,\n            id: user.providerData[0].uid,\n          }\n          this.component.setState({ user: twitter_user, isUser: true }, () => {\n            this.getUserInfo(twitter_user)\n          })\n        } else {\n          if (this.opts.redirect === true) {\n            window.location.href = '/'\n          } else {\n            this.component.setState({ user: null, isUser: false })\n          }\n        }\n      })\n    }\n  }\n\n  // users\n  setData(value, cb, err) {\n    if (err == undefined) {\n      err = e => {\n        console.log(e)\n        this.component.alerts.pushAlert(\n          `エラーが発生しました。時間をおいてもう一度お試し下さい！`\n        )\n      }\n    }\n    this.db\n      .collection('users')\n      .doc(this.component.state.user.uid)\n      .set(value, { merge: true })\n      .then(ss => {\n        cb()\n      })\n      .catch(e => {\n        err(e)\n      })\n  }\n  updateData(value, cb, err) {\n    if (err == undefined) {\n      err = e => {\n        console.log(e)\n        if (e.toString().match(/no document to update/i) !== null) {\n          this.setData(value, cb, err)\n        } else {\n          this.component.alerts.pushAlert(\n            `エラーが発生しました。時間をおいてもう一度お試し下さい！`\n          )\n        }\n      }\n    }\n\n    this.db\n      .collection('users')\n      .doc(this.component.state.user.uid)\n      .update(value)\n      .then(ss => {\n        cb()\n      })\n      .catch(e => {\n        err(e)\n      })\n  }\n\n  getUserInfo(user) {\n    this.db\n      .collection('users')\n      .doc(user.uid)\n      .get()\n      .then(ss => {\n        let userInfo = ss.data() || {}\n        this.component.setState({ userInfo: userInfo }, () => {\n          if (this.opts.oauth != undefined) {\n            this.validateWavesAddress(this.opts.oauth)\n          }\n        })\n      })\n      .catch(e => {\n        console.log(e)\n      })\n  }\n\n  login() {\n    firebase\n      .auth()\n      .signInWithPopup(this.provider)\n      .then(() => {\n        window.location.href = '/home/'\n      })\n      .catch(error => {\n        alert('ログインに失敗しました！もう一度お試し下さい。')\n      })\n  }\n  logout() {\n    firebase\n      .auth()\n      .signOut()\n      .then(() => {\n        window.location.href = '/'\n      })\n      .catch(error => {\n        alert('ログアウトに失敗しました。もう一度お試し下さい。')\n      })\n  }\n\n  // waves\n  validateWavesAddress(popup_url) {\n    const redirectedUrl = popup_url\n    const parsedUrl = url.parse(redirectedUrl, true)\n    const signedData = parsedUrl.query.d\n\n    /* \n       todo: need to verify signature, but the current code on the demo page is not working!!\n       https://demo.wavesplatform.com/\n    */\n    const signature = parsedUrl.query.s\n    const publicKey = parsedUrl.query.p\n    const address = parsedUrl.query.a\n    const [random_value, uid] = signedData.split('_')\n    if (\n      uid != this.component.state.user.uid ||\n      random_value != this.component.state.userInfo.random_value ||\n      this.Waves.crypto.isValidAddress(address) == false\n    ) {\n      this.component.alerts.pushAlert(\n        `認証に失敗しました。時間を置いて再度お試し下さい。`\n      )\n    } else {\n      this.addWavesAddress({\n        publickKey: publicKey,\n        address: address,\n        added_at: Date.now(),\n      })\n    }\n  }\n  setAsReceiver(address) {\n    let waves_addresses = this.component.state.userInfo.waves_addresses || {}\n    for (let k in waves_addresses) {\n      if (k == address) {\n        waves_addresses[k].receiver = true\n      } else {\n        delete waves_addresses[k].receiver\n      }\n    }\n    this.setWavesAddress(waves_addresses, () => {\n      this.component.alerts.pushAlert(\n        `受け取りアドレスを${address} に変更しました！`,\n        `success`\n      )\n    })\n  }\n  checkAddressInPool(address, cb) {\n    this.db\n      .collection('addresses')\n      .doc(address)\n      .get()\n      .then(ss => {\n        if (ss.exists) {\n          this.component.alerts.pushAlert(\n            `${address}は既に他の人に登録されているため使えません。`\n          )\n        } else {\n          cb()\n        }\n      })\n      .catch(e => {\n        console.log(e)\n        this.component.alerts.pushAlert(\n          `エラーが発生しました。時間をおいてもう一度お試し下さい！`\n        )\n      })\n  }\n  addWavesAddress(address) {\n    let waves_addresses = this.component.state.userInfo.waves_addresses || {}\n    if (waves_addresses[address.address] != undefined) {\n      this.component.alerts.pushAlert(\n        `${address.address} は既に登録されています！`,\n        `warning`\n      )\n    } else {\n      this.checkAddressInPool(address.address, () => {\n        if (_.isEmpty(waves_addresses)) {\n          address.receiver = true\n        }\n        waves_addresses[address.address] = address\n        this.setWavesAddress(waves_addresses, () => {\n          this.addAddressToPool(address.address, () => {\n            this.component.alerts.pushAlert(\n              `${address.address} を追加しました！`,\n              `success`\n            )\n          })\n        })\n      })\n    }\n  }\n  setWavesAddress(waves_addresses, cb) {\n    this.updateData({ waves_addresses: waves_addresses }, () => {\n      let userInfo = this.component.state.userInfo || {}\n      userInfo.waves_addresses = waves_addresses\n      this.component.setState({ userInfo: userInfo }, () => {})\n      cb()\n    })\n  }\n  removeAddressFromPool(address, cb) {\n    this.db\n      .collection('addresses')\n      .doc(address)\n      .delete()\n      .then(ss => {\n        cb()\n      })\n      .catch(e => {\n        cb()\n      })\n  }\n  addAddressToPool(address, cb) {\n    this.db\n      .collection('addresses')\n      .doc(address)\n      .set({ uid: this.component.state.user.uid })\n      .then(ss => {\n        cb()\n      })\n      .catch(e => {\n        cb()\n      })\n  }\n  genRandomValue(cb) {\n    let uuid = uuidv4()\n    this.setData({ random_value: uuid }, () => {\n      let userInfo = this.component.state.userInfo || {}\n      userInfo.random_value = uuid\n      this.component.setState({ userInfo: userInfo }, () => {\n        cb(uuid)\n      })\n    })\n  }\n  removeWavesAddress(address) {\n    let waves_addresses = this.component.state.userInfo.waves_addresses || {}\n    delete waves_addresses[address]\n    this.setWavesAddress(waves_addresses, () => {\n      this.removeAddressFromPool(address, () => {\n        this.component.alerts.pushAlert(`${address} を削除しました！`)\n      })\n    })\n  }\n}\n\nexport default Auth\n"],"sourceRoot":""}