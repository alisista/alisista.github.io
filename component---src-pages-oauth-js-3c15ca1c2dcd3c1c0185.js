(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{147:function(e,t,a){"use strict";a.r(t),a(52);var n=a(12),s=a.n(n),r=a(0),o=a.n(r),i=a(158),c=a.n(i),l=a(156),d=a(163),u=(a(167),a(162)),m=a.n(u),h=function(e){function t(t){var a;a=e.call(this,t)||this;var n=t.location.href,s=m.a.parse(n,!0),r=null;return void 0!=s.query.a&&void 0!=s.query.s&&void 0!=s.query.d&&void 0!=s.query.p&&(r=t.location.origin+"/home/"+t.location.search),a.state={redirect:r},a}s()(t,e);var a=t.prototype;return a.render=function(){console.log(this.state.redirect);var e=void 0===this.state.redirect?this.render_wrongPage():this.render_oauth();return o.a.createElement(l.a,null,o.a.createElement(c.a,{link:[{rel:"stylesheet",type:"text/css",href:"/tabler/css/tabler.min.css"},{rel:"stylesheet",type:"text/css",href:"/css/common.css"}]}),o.a.createElement("div",{className:"page"},o.a.createElement("div",{className:"flax-fill"},o.a.createElement("div",{className:"header py-4"},o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"d-flex"},o.a.createElement("a",{className:"header-brand",href:"/"},"ALIS HackerToken")))))),o.a.createElement("div",{className:"my-3 my-md-5"},e),o.a.createElement(d.a,{items:[{key:"twitter",href:"https://twitter.com/alishackers"},{key:"github",href:"https://github.com/alisista"},{key:"discord",href:"https://discord.gg/TyKbbrT"}]}))},a.render_wrongPage=function(){return o.a.createElement("div",{className:"page"},o.a.createElement("div",{className:"page-content"},o.a.createElement("div",{className:"container text-center"},o.a.createElement("div",{className:"display-1 text-muted mb-5"},o.a.createElement("i",{className:"si si-exclamation"})," 404"),o.a.createElement("h1",{className:"h2 mb-3"},"お探しのページは見つかりませんでした。"),o.a.createElement("p",{className:"h4 text-muted font-weight-normal mb-7"},"法定通貨に依存しない完全独自経済圏で好きなことを追求して生きていこう！"),o.a.createElement("a",{className:"btn btn-primary",href:"/"},o.a.createElement("i",{className:"fe fe-arrow-left mr-2"}),"トップページへ戻る"))))},a.render_oauth=function(){return o.a.createElement("div",{className:"page"},o.a.createElement("div",{className:"page-content"},o.a.createElement("div",{className:"container text-center"},o.a.createElement("div",{className:"display-1 text-muted mb-5"},o.a.createElement("i",{className:"si si-exclamation"})," 認証中"),o.a.createElement("h1",{className:"h2 mb-3"},"リダイレクト待ちです。少々お待ち下さい。"),o.a.createElement("p",{className:"h4 text-muted font-weight-normal mb-7"},"自動的にリダイレクトされない場合は、下のボタンをクリックして手動で移動して下さい。"),o.a.createElement("a",{className:"btn btn-primary",href:this.state.redirect},o.a.createElement("i",{className:"fe fe-arrow-left mr-2"}),"認証を続ける"))))},t}(r.Component);t.default=h},152:function(e,t,a){var n;e.exports=(n=a(159))&&n.default||n},155:function(e,t,a){"use strict";a.r(t),a.d(t,"graphql",function(){return f}),a.d(t,"StaticQueryContext",function(){return m}),a.d(t,"StaticQuery",function(){return h});var n=a(0),s=a.n(n),r=a(8),o=a.n(r),i=a(151),c=a.n(i);a.d(t,"Link",function(){return c.a}),a.d(t,"withPrefix",function(){return i.withPrefix}),a.d(t,"navigate",function(){return i.navigate}),a.d(t,"push",function(){return i.push}),a.d(t,"replace",function(){return i.replace}),a.d(t,"navigateTo",function(){return i.navigateTo});var l=a(152),d=a.n(l);a.d(t,"PageRenderer",function(){return d.a});var u=a(31);a.d(t,"parsePath",function(){return u.a});var m=s.a.createContext({}),h=function(e){return s.a.createElement(m.Consumer,null,function(t){return e.data||t[e.query]&&t[e.query].data?(e.render||e.children)(e.data?e.data.data:t[e.query].data):s.a.createElement("div",null,"Loading (StaticQuery)")})};function f(){throw new Error("It appears like Gatsby is misconfigured. Gatsby related `graphql` calls are supposed to only be evaluated at compile time, and then compiled away,. Unfortunately, something went wrong and the query was left in the compiled code.\n\n.Unless your site has a complex or custom babel/Gatsby configuration this is likely a bug in Gatsby.")}h.propTypes={data:o.a.object,query:o.a.string.isRequired,render:o.a.func,children:o.a.func}},156:function(e,t,a){"use strict";var n=a(157),s=a(0),r=a.n(s),o=a(8),i=a.n(o),c=a(158),l=a.n(c),d=a(155),u=function(e){var t=e.children;return r.a.createElement(d.StaticQuery,{query:"755544856",render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a,{title:e.site.siteMetadata.title,meta:[{name:"description",content:"法定通貨に依存しない完全独自経済圏"},{name:"keywords",content:"ALIS Hacker Token, ALISハッカー部"}]},r.a.createElement("html",{lang:"en"})),t)},data:n})};u.propTypes={children:i.a.node.isRequired},t.a=u},157:function(e){e.exports={data:{site:{siteMetadata:{title:"ALIS Hacker Token - ALISハッカー部"}}}}},159:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(8),o=a.n(r),i=a(36),c=a(1),l=function(e){var t=e.location,a=c.a.getResourcesForPathname(t.pathname);return s.a.createElement(i.a,{location:t,pageResources:a})};l.propTypes={location:o.a.shape({pathname:o.a.string.isRequired}).isRequired},t.default=l},163:function(e,t,a){"use strict";a(164),a(165),a(79),a(166);var n=a(12),s=a.n(n),r=a(0),o=a.n(r),i=function(e){function t(t){return e.call(this,t)||this}return s()(t,e),t.prototype.render=function(){var e=[],t=this.props.items,a=Array.isArray(t),n=0;for(t=a?t:t[Symbol.iterator]();;){var s;if(a){if(n>=t.length)break;s=t[n++]}else{if((n=t.next()).done)break;s=n.value}var r=s;e.push(o.a.createElement("li",{className:"list-inline-item"},o.a.createElement("a",{href:r.href,target:"_blank"},o.a.createElement("i",{className:"fab fa-"+r.key}))))}return o.a.createElement("footer",null,o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-4"},o.a.createElement("span",{className:"copyright"},"Copyright © ALISハッカー部 2018")),o.a.createElement("div",{className:"col-md-4"},o.a.createElement("ul",{className:"list-inline social-buttons"},e)),o.a.createElement("div",{className:"col-md-4"},o.a.createElement("ul",{className:"list-inline quicklinks"})))))},t}(r.Component);t.a=i},167:function(e,t,a){"use strict";a(170),a(81),a(171),a(172),a(173);var n=a(174),s=a.n(n),r=a(177),o=a.n(r),i=a(162),c=a.n(i),l=a(161),d=a.n(l),u=a(178),m=(a(179),u.create(u.MAINNET_CONFIG));a(180),s.a.initializeApp({apiKey:"AIzaSyAsl3dTaQWj8ljxb-2tLJd7FTYtexGInio",authDomain:"alishackers-f5d05.firebaseapp.com",databaseURL:"https://alishackers-f5d05.firebaseio.com",projectId:"alishackers-f5d05",storageBucket:"alishackers-f5d05.appspot.com",messagingSenderId:"791078170170",timestampsInSnapshots:!0});var h=function(){function e(e,t){var a=this;void 0===t&&(t={}),this.opts=t,this.component=e,this.db=s.a.firestore(),this.provider=new s.a.auth.TwitterAuthProvider,s.a.auth().useDeviceLanguage(),s.a.auth().onAuthStateChanged(function(e,t){if(e){var n={displayName:e.displayName,photoURL:e.photoURL,uid:e.uid,id:e.providerData[0].uid};a.component.setState({user:n,isUser:!0},function(){a.getUserInfo(n)})}else!0===a.opts.redirect?window.location.href="/":a.component.setState({user:null,isUser:!1})})}var t=e.prototype;return t.setData=function(e,t,a){var n=this;void 0==a&&(a=function(e){console.log(e),n.component.alerts.pushAlert("エラーが発生しました。時間をおいてもう一度お試し下さい！")}),this.db.collection("users").doc(this.component.state.user.uid).set(e,{merge:!0}).then(function(e){t()}).catch(function(e){a(e)})},t.updateData=function(e,t,a){var n=this;void 0==a&&(a=function(s){console.log(s),null!==s.toString().match(/no document to update/i)?n.setData(e,t,a):n.component.alerts.pushAlert("エラーが発生しました。時間をおいてもう一度お試し下さい！")}),this.db.collection("users").doc(this.component.state.user.uid).update(e).then(function(e){t()}).catch(function(e){a(e)})},t.getUserInfo=function(e){var t=this;this.db.collection("users").doc(e.uid).get().then(function(e){var a=e.data()||{};t.component.setState({userInfo:a},function(){void 0!=t.opts.oauth&&t.validateWavesAddress(t.opts.oauth)})}).catch(function(e){console.log(e)})},t.login=function(){s.a.auth().signInWithPopup(this.provider).then(function(){window.location.href="/home/"}).catch(function(e){alert("ログインに失敗しました！もう一度お試し下さい。")})},t.logout=function(){s.a.auth().signOut().then(function(){window.location.href="/"}).catch(function(e){alert("ログアウトに失敗しました。もう一度お試し下さい。")})},t.validateWavesAddress=function(e){var t=e,a=c.a.parse(t,!0),n=a.query.d,s=(a.query.s,a.query.p),r=a.query.a,o=n.split("_"),i=o[0];o[1]!=this.component.state.user.uid||i!=this.component.state.userInfo.random_value||0==m.crypto.isValidAddress(r)?this.component.alerts.pushAlert("認証に失敗しました。時間を置いて再度お試し下さい。"):this.addWavesAddress({publickKey:s,address:r,added_at:Date.now()})},t.setAsReceiver=function(e){var t=this,a=this.component.state.userInfo.waves_addresses||{};for(var n in a)n==e?a[n].receiver=!0:delete a[n].receiver;this.setWavesAddress(a,function(){t.component.alerts.pushAlert("受け取りアドレスを"+e+" に変更しました！","success")})},t.checkAddressInPool=function(e,t){var a=this;this.db.collection("addresses").doc(e).get().then(function(n){n.exists?a.component.alerts.pushAlert(e+"は既に他の人に登録されているため使えません。"):t()}).catch(function(e){console.log(e),a.component.alerts.pushAlert("エラーが発生しました。時間をおいてもう一度お試し下さい！")})},t.addWavesAddress=function(e){var t=this,a=this.component.state.userInfo.waves_addresses||{};void 0!=a[e.address]?this.component.alerts.pushAlert(e.address+" は既に登録されています！","warning"):this.checkAddressInPool(e.address,function(){d.a.isEmpty(a)&&(e.receiver=!0),a[e.address]=e,t.setWavesAddress(a,function(){t.addAddressToPool(e.address,function(){t.component.alerts.pushAlert(e.address+" を追加しました！","success")})})})},t.setWavesAddress=function(e,t){var a=this;this.updateData({waves_addresses:e},function(){var n=a.component.state.userInfo||{};n.waves_addresses=e,a.component.setState({userInfo:n},function(){}),t()})},t.removeAddressFromPool=function(e,t){this.db.collection("addresses").doc(e).delete().then(function(e){t()}).catch(function(e){t()})},t.addAddressToPool=function(e,t){this.db.collection("addresses").doc(e).set({uid:this.component.state.user.uid}).then(function(e){t()}).catch(function(e){t()})},t.genRandomValue=function(e){var t=this,a=o()();this.setData({random_value:a},function(){var n=t.component.state.userInfo||{};n.random_value=a,t.component.setState({userInfo:n},function(){e(a)})})},t.removeWavesAddress=function(e){var t=this,a=this.component.state.userInfo.waves_addresses||{};delete a[e],this.setWavesAddress(a,function(){t.removeAddressFromPool(e,function(){t.component.alerts.pushAlert(e+" を削除しました！")})})},e}();t.a=h}}]);
//# sourceMappingURL=component---src-pages-oauth-js-3c15ca1c2dcd3c1c0185.js.map